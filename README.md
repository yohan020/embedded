# 스마트 클린캠

## 한줄 요약
홈캠 + 로봇 청소기 = 스마트 클린캠

## 주요기능
- 자동 청소 및 수동 청소
- wifi를 통한 카메라 스트리밍
- 블루투스를 통한 청소기 제어

## 전체 시스템 구조
<img width="2511" height="1332" alt="image" src="https://github.com/user-attachments/assets/c792c3f3-31a8-4462-a0e6-1cd842b717ee" />


- 개발 언어 : C언어 및 파이썬
- 라이브러리 : softpwm, wiringPi
- 기타 : flask 웹서버

## 멀티쓰레드 구조
 - 경로 계산 쓰레드
 - 블루투스 통신 쓰레드
 - 센서 측정 쓰레드
 - 모터 제어 쓰레드
 
 - 파이썬 : 카메라 스트리밍
 
### 공유변수
- Mutex 사용
  - 모터 제어 변수
    - 블루투스 통신 쓰레드에서 명령을 받을 경우
    - 경로 계산 쓰레드에서 모터에 지시를 내릴 경우
    - 모터 제어 쓰레드에서 변수를 참조하여 모터를 구동시킬 경우
  - 수동/자동 모드 전환 변수
    - 경로 계산 쓰레드에서 경로 제어 알고리즘을 사용할지 여부를 결정할 경우
  - 초음파 센서 거리 변수
    - 초음파로 측정된 값을 변수에 기록할 경우
    - 경로 계산 쓰레드에서 센서값을 이용해서 경로를 제어할 경우
  - 시스템 시작/종료 변수
    - 모터 제어 쓰레드에서 각종 모터를 제어할지 정할 경우
<img width="2114" height="1127" alt="image" src="https://github.com/user-attachments/assets/a971e88a-5dce-4d37-9ecb-50900058cbe6" />


## 빌드 및 실행 방법
- C 언어 파일 실행 코드
```
gcc -o robot_car main.c bluetooth.c sensors.c motors.c navigator.c -lwiringPi -lpthread -lm
```
- 파이썬 실행 코드
```
python camera_streaming.py
```
## 데모 영상
- demo 폴더 내 영상 참조
## 문제점 및 해결 방안 / 한계
- 전원 분배
  - 11.1v의 전원장치로 고출력의 흡입모터와 각종 액추에이터 및 센서, 라즈베리를 무리하게 가동하게 되면 전원이 꺼지는 현상이 발생
  - 만약, 흡입모터의 출력을 낮출 경우 흡입력이 현저히 낮아짐
  - 해결법 : 흡입모터를 제외한 부품은 별도의 보조베터리를 통해 전원을 공급함
- 영상 송출 문제
  - C언어를 통해서 구현하려고 하였지만 C언어로는 구현이 되지않음
  - 교내 wifi를 통해서 로컬망으로 스트리밍을 시도하였지만 네트워크 보안 문제로 불가능 하게됨
  - 해결법 : 파이썬으로 구현하였고 핫스팟을 통해 네트워크 문제 해결함
- GPIO 출력 한계
  - 라즈베리파이의 GPIO 출력은 3.3v가 최고인데 흡입모터의 최고 입력 신호 전압은 5v이기 때문에 흡입모터의 최고 성능을 내지는 못함
## 팀원 및 역할
- 김재윤 : 회로도 설계, 하드웨어 및 외관 제작
- 이요한 : 센서 및 블루투스 통신 부분 개발, 청소기 조종 어플 개발
- 이용준 : 메인 소스코드 설계, 모터 및 경로제어 부분 개발
- 정연우 : 카메라 담당 및 로컬망과 웹서버를 통한 스트리밍 구현
